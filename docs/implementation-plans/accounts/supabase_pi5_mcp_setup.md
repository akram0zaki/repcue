
# Supabase on Raspberry Pi 5 + MCP Servers for VS Code & Cursor

**Target device:** Raspberry Pi 5 (64‑bit Raspberry Pi OS).  
**User:** `pi2`  
**Editors:** VS Code and Cursor (both with **trusted MCP servers**).

This guide gets you:
1) A **self‑hosted Supabase** stack running on your Pi via Docker.  
2) A **local development workflow** with the Supabase CLI.  
3) **MCP servers** wired into VS Code & Cursor so AI can help you manage tables, run queries, and troubleshoot.

> ℹ️ Notes on MCP:
> - **Official Supabase MCP** connects to **Supabase Cloud** projects using a Personal Access Token (PAT).  
> - For **local self‑hosted** Postgres on your Pi, use the **Postgres MCP** (official) which is **read‑only** by design, or use a **community Supabase MCP** that supports self‑hosted instances (more powerful but third‑party). Pick what matches your risk tolerance.

---

## 0) Prerequisites

- Raspberry Pi OS **64‑bit** (ARM64). Check with:
  ```bash
  uname -m
  ```
  You should see `aarch64` or `arm64`.
- Update packages:
  ```bash
  sudo apt update && sudo apt full-upgrade -y && sudo reboot
  ```

---

## 1) Install Docker & Docker Compose

```bash
# 1. Install Docker Engine
curl -fsSL https://get.docker.com | sh

# 2. Allow user pi2 to run docker without sudo
sudo usermod -aG docker pi2
newgrp docker

# 3. Enable and test
sudo systemctl enable docker
docker run --rm hello-world

# 4. Install Compose plugin (on Debian/RPiOS)
sudo apt install -y docker-compose-plugin
docker compose version
```

If `docker compose version` prints a version, you’re set.

---

## 2) Install Supabase CLI (ARM64)

The CLI orchestrates a local Supabase stack via Docker.

```bash
# Install via npm (works well on ARM64)
sudo apt install -y nodejs npm
sudo npm i -g supabase

# Verify
supabase --version
```

> Alternative: Download a Linux ARM64 binary from Supabase releases if you prefer not to use npm.

---

## 3) Initialize a local Supabase project (on the Pi)

Choose a directory for your local stack (e.g., `/home/pi2/supabase-local`):

```bash
mkdir -p ~/supabase-local && cd ~/supabase-local

# Initialize project scaffolding
supabase init

# Start the local stack (Postgres, Studio, etc.)
supabase start
```

### Default local endpoints (printed by the CLI)
- Studio (web console): `http://127.0.0.1:54323`
- Postgres: `localhost:54322`
- API: `http://127.0.0.1:54321`
- Inbucket (email testing): `http://127.0.0.1:54324`

If you are SSH’ing into the Pi from your laptop, use SSH port forwarding to access Studio in your browser:
```bash
# Run on your laptop:
ssh -L 54323:127.0.0.1:54323 pi2@<pi-ip-address>
# then open http://127.0.0.1:54323 in your laptop browser
```

### Persisting database data
The CLI creates Docker volumes for persistence. To stop/start:
```bash
supabase stop
supabase start
```

---

## 4) Connect your React app to the local Supabase (dev only)

From your project (on your dev machine), set `.env.local` with the keys printed by `supabase start` (anon and service role). Typical values when running locally are auto‑generated by the CLI and safe for dev.

```env
VITE_SUPABASE_URL=http://<pi-ip>:54321
VITE_SUPABASE_ANON_KEY=<anon-key-from-supabase-start>
```

> Keep **service role** keys server‑side only (not in the browser).

---

## 5) (Option A) Official **Supabase MCP** — for **Supabase Cloud** projects

This is the most supported path if you also use Supabase Cloud. It lets your AI tools (VS Code/Cursor) **create tables, run SQL, manage config** on your cloud project.

1. **Create a PAT** (Personal Access Token) in your Supabase Cloud account.
2. **Get your Project Ref** from the Cloud project settings.

### VS Code (Copilot Chat) setup

Add the MCP server to your VS Code `settings.json`:

```jsonc
{
  "mcp.servers": {
    "supabase": {
      "command": "npx",
      "args": ["-y", "@supabase-community/supabase-mcp@latest"],
      "env": {
        "SUPABASE_ACCESS_TOKEN": "your_pat_here",
        "SUPABASE_PROJECT_REF": "your_project_ref_here"
      }
    }
  }
}
```

Restart VS Code. In Copilot Chat, you’ll see Supabase tools (e.g., run SQL, manage tables).

### Cursor setup

Create or edit `.cursor/mcp.json` in your repo:

```json
{
  "clients": {
    "default": {
      "transport": {
        "type": "stdio"
      },
      "servers": {
        "supabase": {
          "command": "npx",
          "args": ["-y", "@supabase-community/supabase-mcp@latest"],
          "env": {
            "SUPABASE_ACCESS_TOKEN": "your_pat_here",
            "SUPABASE_PROJECT_REF": "your_project_ref_here"
          }
        }
      }
    }
  }
}
```

Restart Cursor. You should see the Supabase MCP server appear under Tools.

> **Security tip:** Prefer storing secrets via each editor’s secret storage if available. Avoid committing PATs.

---

## 6) (Option B) **Postgres MCP** — for **local self‑hosted** database on the Pi (read‑only)

If you want your AI tools to **query** the local DB on the Pi for **inspection/troubleshooting** (read‑only), use the official Postgres MCP server.

### VS Code

```jsonc
{
  "mcp.servers": {
    "postgres": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-postgres@latest"],
      "env": {
        "PGHOST": "<pi-ip-or-127.0.0.1>",
        "PGPORT": "54322",
        "PGUSER": "postgres",
        "PGPASSWORD": "postgres",
        "PGDATABASE": "postgres",
        "PGSSLMODE": "disable"
      }
    }
  }
}
```

### Cursor

`.cursor/mcp.json`:

```json
{
  "clients": {
    "default": {
      "transport": { "type": "stdio" },
      "servers": {
        "postgres": {
          "command": "npx",
          "args": ["-y", "@modelcontextprotocol/server-postgres@latest"],
          "env": {
            "PGHOST": "<pi-ip-or-127.0.0.1>",
            "PGPORT": "54322",
            "PGUSER": "postgres",
            "PGPASSWORD": "postgres",
            "PGDATABASE": "postgres",
            "PGSSLMODE": "disable"
          }
        }
      }
    }
  }
}
```

> ⚠️ **Read‑only limitation:** This server runs queries in read‑only transactions for safety. Use it to explore schema, run `SELECT`s, and troubleshoot without risk.

---

## 7) (Option C, advanced) Community **Self‑Hosted Supabase MCP** (read/write)

If you need **write** access (create tables, etc.) against the **self‑hosted** Supabase on your Pi from VS Code/Cursor, consider a community MCP server built for self‑hosted instances. Example (one of several in the wild):

- `@supabase-community/supabase-mcp` (connects with access tokens / service role keys)
- Other variants exist; evaluate maintenance and security before use.

### Example VS Code entry

```jsonc
{
  "mcp.servers": {
    "supabase-local": {
      "command": "npx",
      "args": ["-y", "@supabase-community/supabase-mcp@latest"],
      "env": {
        "SUPABASE_URL": "http://<pi-ip>:54321",
        "SUPABASE_SERVICE_ROLE_KEY": "<service-role-key-from_supabase_start>"
      }
    }
  }
}
```

### Example Cursor entry

```json
{
  "clients": {
    "default": {
      "transport": { "type": "stdio" },
      "servers": {
        "supabase-local": {
          "command": "npx",
          "args": ["-y", "@supabase-community/supabase-mcp@latest"],
          "env": {
            "SUPABASE_URL": "http://<pi-ip>:54321",
            "SUPABASE_SERVICE_ROLE_KEY": "<service-role-key_from_supabase_start>"
          }
        }
      }
    }
  }
}
```

> ⚠️ **Security:** Service‑role keys bypass RLS and can write anything. Limit usage to **local dev**. Never commit keys. Consider network scoping so only your LAN can reach the Pi.

---

## 8) Quality‑of‑life tips

- **Swap**: If the Pi is memory‑constrained, a small swap helps during Docker pulls:
  ```bash
  sudo dphys-swapfile swapoff
  echo CONF_SWAPSIZE=2048 | sudo tee /etc/dphys-swapfile
  sudo dphys-swapfile setup && sudo dphys-swapfile swapon
  ```
- **Volumes backup**: `docker volume ls`; `docker run --rm -v <volume>:/v -v $PWD:/b busybox tar czf /b/pgdata.tar.gz -C / v`.
- **Studio auth**: For local dev only; do not expose Studio publicly.
- **Ports**: If 54321–54324 are taken, stop the stack and edit `docker-compose` in `.supabase` to remap host ports.

---

## 9) Quick smoke test

1) In `~/supabase-local`, run `supabase start`.  
2) Open Studio (via SSH tunnel or on the Pi) and create a table.  
3) From VS Code/Cursor, use the configured **MCP server** to `SELECT * FROM your_table`.  
4) Your React app should connect using the local URL and anon key.

---

## 10) Troubleshooting

- **ARM images**: Ensure you are on Raspberry Pi OS **64‑bit**. Most Supabase images are multi‑arch. If a pull fails, try `docker pull --platform linux/arm64 <image>`.
- **Ports busy**: Stop any local Postgres on the same ports. Change port mappings if needed.
- **Cannot reach Pi from laptop**: Confirm IP (e.g., `hostname -I`) and firewall rules, or use SSH port forwarding.
- **MCP not visible**: Double‑check the `settings.json` or `.cursor/mcp.json` path and restart the editor. Check the MCP server logs in the tool panel.
- **Permissions**: If `docker` requires sudo, log out/in or run `newgrp docker` again.

---

## 11) Clean up

```bash
# Stop stack
cd ~/supabase-local
supabase stop

# Remove containers & volumes (destructive)
docker compose -f .supabase/docker/docker-compose.yml down -v
```

---

### Done!

You now have:
- Supabase running on your Pi 5
- Your app connected to it for local dev
- MCP servers in VS Code & Cursor to manage and query the database
